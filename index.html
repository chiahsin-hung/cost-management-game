<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CFO çš„æ±ºç­–æŒ‘æˆ°ï¼šç®¡ç†æœƒè¨ˆå¯¦æˆ° (MBA Edition)</title>
    <style>
        :root {
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --primary: #0f3460;
            --accent: #e94560;
            --text-main: #e0e0e0;
            --text-muted: #a0a0a0;
            --gold: #ffd700;
            --success: #4caf50;
            --error: #f44336;
        }

        body {
            font-family: "Microsoft JhengHei", "Helvetica Neue", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .game-container {
            width: 100%;
            max-width: 900px;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* Header & Stats */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--card-bg);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            border-left: 5px solid var(--accent);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .game-title h1 {
            margin: 0;
            font-size: 1.5rem;
            color: #fff;
        }

        .game-title p {
            margin: 0.3rem 0 0;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .stats {
            display: flex;
            gap: 2rem;
            text-align: right;
        }

        .stat-item .label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-item .value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--gold);
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), #ff9a9e);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Scenario Card */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .level-badge {
            display: inline-block;
            background: var(--primary);
            color: var(--text-main);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255,255,255,0.1);
        }

        h2.scenario-title {
            margin-top: 0;
            color: var(--gold);
            font-size: 1.8rem;
        }

        .scenario-text {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
            border-left: 3px solid rgba(255,255,255,0.2);
            padding-left: 1rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 0.95rem;
        }

        .data-table th, .data-table td {
            border: 1px solid rgba(255,255,255,0.1);
            padding: 10px;
            text-align: left;
        }

        .data-table th {
            background: rgba(0,0,0,0.2);
            color: var(--accent);
        }

        .data-table tr:nth-child(even) {
            background: rgba(255,255,255,0.03);
        }

        .question-box {
            background: rgba(0,0,0,0.2);
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .option-btn {
            background: transparent;
            border: 2px solid rgba(255,255,255,0.2);
            color: var(--text-main);
            padding: 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        .option-btn:hover:not(:disabled) {
            border-color: var(--accent);
            background: rgba(233, 69, 96, 0.1);
        }

        .option-btn.selected {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .option-btn.correct {
            border-color: var(--success);
            background: rgba(76, 175, 80, 0.2);
        }

        .option-btn.wrong {
            border-color: var(--error);
            background: rgba(244, 67, 54, 0.2);
        }

        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Feedback Modal */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .feedback-card {
            background: var(--card-bg);
            padding: 2.5rem;
            border-radius: 16px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .feedback-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            display: block;
        }

        .feedback-title {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #fff;
        }

        .feedback-message {
            color: var(--text-muted);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .next-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s;
            font-weight: bold;
        }

        .next-btn:hover {
            transform: scale(1.05);
            background: #ff5e78;
        }

        @media (max-width: 768px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
            .stats {
                gap: 1rem;
            }
            .stat-item .value {
                font-size: 1.2rem;
            }
        }

        /* Intro Screen */
        #intro-screen {
            text-align: center;
        }

        .start-btn {
            background: var(--gold);
            color: #000;
            border: none;
            padding: 1.2rem 3rem;
            font-size: 1.3rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 2rem;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            transition: all 0.3s;
        }

        .start-btn:hover {
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            transform: translateY(-3px);
        }
    </style>
</head>
<body>

    <div class="game-container">
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>

        <!-- Header -->
        <header>
            <div class="game-title">
                <h1>CFO çš„æ±ºç­–æŒ‘æˆ°</h1>
                <p>Advanced Managerial Accounting Simulation</p>
            </div>
            <div class="stats">
                <div class="stat-item">
                    <div class="label">Level</div>
                    <div class="value" id="level-display">1 / 4</div>
                </div>
                <div class="stat-item">
                    <div class="label">Score</div>
                    <div class="value" id="score-display">0</div>
                </div>
            </div>
        </header>

        <!-- Intro Screen -->
        <div id="intro-screen" class="card">
            <h2 style="font-size: 2.5rem; color: var(--gold); margin-bottom: 1rem;">æ­¡è¿ä¾†åˆ°è‘£äº‹æœƒ</h2>
            <p style="font-size: 1.2rem; margin-bottom: 2rem;">
                æ‚¨å·²è¢«ä»»å‘½ç‚ºé›†åœ˜æ–°ä»» CFOã€‚æœªä¾†çš„å¹¾å€‹å­£åº¦ï¼Œæ‚¨å°‡é¢è‡¨ä¸€ç³»åˆ—æ£˜æ‰‹çš„ç®¡ç†æ±ºç­–ã€‚<br>
                å¾æˆæœ¬çµæ§‹åˆ†æåˆ°è·¨éƒ¨é–€è½‰æ’¥è¨ˆåƒ¹ï¼Œæ¯ä¸€å€‹æ•¸å­—èƒŒå¾Œéƒ½ä»£è¡¨è‘—ç­–ç•¥æ–¹å‘ã€‚<br><br>
                <strong>æŒ‘æˆ°è¦å‰‡ï¼š</strong><br>
                1. æ¯å€‹é—œå¡ä»£è¡¨ä¸€å€‹çœŸå¯¦å•†æ¥­æƒ…å¢ƒã€‚<br>
                2. æ‚¨å¿…é ˆæ ¹æ“šæä¾›çš„æ•¸æ“šé€²è¡Œè¨ˆç®—ã€‚<br>
                3. åšå‡ºæ­£ç¢ºçš„æ±ºç­–ï¼ˆé¸æ“‡é¡Œï¼‰æ‰èƒ½æ™‰ç´šã€‚<br>
                4. éŒ¯èª¤çš„æ±ºç­–å°‡å°è‡´è‚¡åƒ¹ä¸‹è·Œï¼ˆæ‰£åˆ†ï¼‰ã€‚
            </p>
            <button class="start-btn" onclick="game.start()">æ¥å—ä»»å‘½ (Start)</button>
        </div>

        <!-- Game Area (Hidden initially) -->
        <div id="game-area" class="card" style="display: none;">
            <div class="level-badge" id="level-badge">LEVEL 1 - æˆæœ¬è¡Œç‚ºåˆ†æ</div>
            <h2 class="scenario-title" id="scenario-title">æƒ…å¢ƒæ¨™é¡Œ</h2>
            <div class="scenario-text" id="scenario-text">
                æƒ…å¢ƒæè¿°...
            </div>
            <div id="data-container">
                <!-- Data table injected here -->
            </div>
            
            <div class="question-box">
                <div class="question-text" id="question-text">é¡Œç›®...</div>
                <div class="options-grid" id="options-grid">
                    <!-- Options injected here -->
                </div>
            </div>
        </div>

    </div>

    <!-- Feedback Overlay -->
    <div class="feedback-overlay" id="feedback-overlay">
        <div class="feedback-card">
            <span class="feedback-icon" id="feedback-icon">âœ…</span>
            <h2 class="feedback-title" id="feedback-title">æ±ºç­–æ­£ç¢º</h2>
            <div class="feedback-message" id="feedback-message">
                è§£é‡‹ç‚ºä½•æ­£ç¢º...
            </div>
            <button class="next-btn" id="feedback-btn" onclick="game.nextLevel()">ä¸‹ä¸€é—œ</button>
        </div>
    </div>

    <script>
        const levels = [
            {
                id: 1,
                title: "å›æ­¸åˆ†æèˆ‡æˆæœ¬ä¼°è¨ˆ",
                badge: "Level 1: Cost Estimation",
                scenario: `
                    <p><strong>æƒ…å¢ƒï¼š</strong> é›†åœ˜æ­£è€ƒæ…®æ“´å»ºæ–°çš„ç‰©æµä¸­å¿ƒã€‚ä½œç‚º CFOï¼Œæ‚¨è¦æ±‚åˆ†æéƒ¨é–€æä¾›éå» 12 å€‹æœˆçš„ã€Œç¶­ä¿®è²»ç”¨ã€èˆ‡ã€Œæ©Ÿå™¨é‹è½‰å°æ™‚ã€æ•¸æ“šã€‚åˆ†æåœ˜éšŠè·‘äº†ä¸€ä»½ç°¡å–®è¿´æ­¸åˆ†æ (Simple Regression Analysis)ï¼Œå ±å‘Šé¡¯ç¤ºå¦‚ä¸‹ï¼š</p>
                    <table class="data-table">
                        <tr><th>é …ç›®</th><th>ä¿‚æ•¸ (Coefficients)</th><th>t-Stat</th></tr>
                        <tr><td>æˆªè·é … (Intercept)</td><td>15,000</td><td>1.85</td></tr>
                        <tr><td>X è®Šæ•¸ (æ©Ÿå™¨å°æ™‚)</td><td>25</td><td>12.4</td></tr>
                    </table>
                    <p><strong>è£œå……è³‡è¨Šï¼š</strong> R-square ç‚º 0.85ï¼›æŸ¥è¡¨å¾—çŸ¥ t-critical value (é›™å°¾, 95%) ç´„ç‚º 2.23ã€‚</p>
                    <p>ç‡Ÿé‹é•·æ‹¿è‘—é€™ä»½å ±å‘Šå•æ‚¨ï¼šã€Œå¦‚æœä¸‹å€‹æœˆé è¨ˆæ©Ÿå™¨é‹è½‰ 2,000 å°æ™‚ï¼Œæˆ‘å€‘æ‡‰è©²ç·¨åˆ—å¤šå°‘ç¶­ä¿®é ç®—ï¼Ÿã€</p>
                `,
                question: "æ ¹æ“šçµ±è¨ˆé¡¯è‘—æ€§èˆ‡æˆæœ¬å‹•å› åˆ†æï¼Œä¸‹åˆ—å“ªå€‹é ç®—ä¼°è¨ˆæ•¸å­—åœ¨ç®¡ç†æ±ºç­–ä¸Šæœ€ç‚ºåˆç†ï¼Ÿ",
                options: [
                    { text: "$65,000 (ç›´æ¥ä»£å…¥å›æ­¸æ–¹ç¨‹å¼ï¼š15,000 + 25Ã—2,000)", isCorrect: false, feedback: "æ‚¨å¿½ç•¥äº†çµ±è¨ˆé¡¯è‘—æ€§ã€‚æˆªè·é …çš„ t-stat (1.85) å°æ–¼è‡¨ç•Œå€¼ (2.23)ï¼Œè¡¨ç¤ºå›ºå®šæˆæœ¬é …åœ¨çµ±è¨ˆä¸Šä¸é¡¯è‘—ç•°æ–¼é›¶ã€‚" },
                    { text: "$50,000 (åƒ…è€ƒæ…®è®Šå‹•éƒ¨åˆ†ï¼š25 Ã— 2,000)", isCorrect: true, feedback: "æ­£ç¢ºï¼ç”±æ–¼æˆªè·é … (å›ºå®šæˆæœ¬) çš„ t-stat < 2.23ï¼Œçµ±è¨ˆä¸Šä¸é¡¯è‘—ï¼Œæ‡‰è¦–ç‚º 0ã€‚å› æ­¤æˆæœ¬å‡½æ•¸æ‡‰ç°¡åŒ–ç‚º Y = 25Xã€‚é ç®— = 25 * 2,000 = 50,000ã€‚" },
                    { text: "$53,125 (è€ƒæ…® R-square èª¿æ•´ï¼š65,000 Ã— 0.85)", isCorrect: false, feedback: "R-square ä»£è¡¨è§£é‡‹åŠ›ï¼Œä¸èƒ½ç›´æ¥ç”¨ä¾†æ‰“æŠ˜é ç®—é‡‘é¡ã€‚" },
                    { text: "$42,500 (åƒ…è€ƒæ…®è®Šå‹•éƒ¨åˆ†ä¸¦èª¿æ•´ R-square)", isCorrect: false, feedback: "é‚è¼¯éŒ¯èª¤ã€‚R-square ä¸å½±éŸ¿é æ¸¬å€¼çš„é»ä¼°è¨ˆè¨ˆç®—ã€‚" }
                ]
            },
            {
                id: 2,
                title: "ç‡Ÿé‹æ§“æ¡¿èˆ‡é¢¨éšªæ±ºç­–",
                badge: "Level 2: CVP & Risk",
                scenario: `
                    <p><strong>æƒ…å¢ƒï¼š</strong> å…©å€‹äº‹æ¥­éƒ¨ (A èˆ‡ B) å»å¹´çš„ç‡Ÿæ”¶çš†ç‚º $1,000,000ï¼Œç‡Ÿæ¥­åˆ©ç›Šçš†ç‚º $100,000ã€‚ä½†å…©è€…çš„æˆæœ¬çµæ§‹æˆªç„¶ä¸åŒï¼š</p>
                    <table class="data-table">
                        <tr><th>é …ç›®</th><th>äº‹æ¥­éƒ¨ A (è‡ªå‹•åŒ–ç¨‹åº¦é«˜)</th><th>äº‹æ¥­éƒ¨ B (äººå·¥å¯†é›†)</th></tr>
                        <tr><td>è®Šå‹•æˆæœ¬ç‡</td><td>20%</td><td>60%</td></tr>
                        <tr><td>å›ºå®šæˆæœ¬</td><td>$700,000</td><td>$300,000</td></tr>
                    </table>
                    <p><strong>æŒ‘æˆ°ï¼š</strong> ç¶“æ¿Ÿå­¸å®¶é æ¸¬æ˜å¹´æ™¯æ°£å°‡é¢è‡¨è¡°é€€ï¼Œé ä¼°ç‡Ÿæ”¶æå°‡<strong>ä¸‹æ»‘ 20%</strong>ã€‚è‘£äº‹æœƒå•æ‚¨ï¼šã€Œåœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œå“ªå€‹äº‹æ¥­éƒ¨çš„ç²åˆ©å—å‚·ç¨‹åº¦æœƒè¼ƒè¼•å¾®ï¼Ÿã€</p>
                `,
                question: "è«‹è¨ˆç®—å…©è€…çš„ç‡Ÿé‹æ§“æ¡¿åº¦ (DOL)ï¼Œä¸¦åˆ¤æ–·èª°çš„ç²åˆ©è¡°é€€å¹…åº¦è¼ƒå°ï¼Ÿ",
                options: [
                    { text: "äº‹æ¥­éƒ¨ A å—å‚·è¼ƒè¼•ï¼Œå› ç‚ºå®ƒçš„é‚Šéš›è²¢ç»ç‡ (CM Ratio) è¼ƒé«˜ (80%)ã€‚", isCorrect: false, feedback: "éŒ¯èª¤ã€‚CM Ratio é«˜æ„å‘³è‘—ç‡Ÿæ”¶æ¯ä¸‹é™ $1ï¼Œæå¤±çš„è²¢ç»æ¯›åˆ©æ›´å¤šã€‚ä¸” A çš„å›ºå®šæˆæœ¬é«˜ï¼ŒDOL è¼ƒé«˜ï¼Œé¢¨éšªè¼ƒå¤§ã€‚" },
                    { text: "äº‹æ¥­éƒ¨ B å—å‚·è¼ƒè¼•ï¼Œå› ç‚ºå®ƒçš„ DOL ç‚º 4ï¼Œä½æ–¼äº‹æ¥­éƒ¨ A çš„ 8ã€‚", isCorrect: true, feedback: "æ­£ç¢ºï¼<br>A çš„ CM = 1,000,000 Ã— 80% = 800,000; DOL = 800,000 / 100,000 = 8ã€‚<br>B çš„ CM = 1,000,000 Ã— 40% = 400,000; DOL = 400,000 / 100,000 = 4ã€‚<br>ç‡Ÿæ”¶ä¸‹æ»‘ 20% æ™‚ï¼ŒB çš„ç²åˆ©åƒ…ä¸‹æ»‘ 4 Ã— 20% = 80%ï¼Œè€Œ A å°‡ä¸‹æ»‘ 8 Ã— 20% = 160% (è½‰ç›ˆç‚ºè™§)ã€‚" },
                    { text: "å…©è€…å—å‚·ç¨‹åº¦ç›¸åŒï¼Œå› ç‚ºå»å¹´çš„ç‡Ÿæ¥­åˆ©ç›Šéƒ½æ˜¯ $100,000ã€‚", isCorrect: false, feedback: "éŒ¯èª¤ã€‚ç‡Ÿæ¥­åˆ©ç›Šç›¸åŒä¸ä»£è¡¨é¢¨éšªçµæ§‹ç›¸åŒï¼Œå¿…é ˆçœ‹æˆæœ¬çµæ§‹ (å›ºå®š vs è®Šå‹•)ã€‚" },
                    { text: "äº‹æ¥­éƒ¨ A å—å‚·è¼ƒè¼•ï¼Œå› ç‚ºå®ƒçš„æç›Šå…©å¹³é»è¼ƒä½ã€‚", isCorrect: false, feedback: "éŒ¯èª¤ã€‚A çš„æç›Šå…©å¹³é» = 700,000 / 0.8 = 875,000ï¼›B çš„æç›Šå…©å¹³é» = 300,000 / 0.4 = 750,000ã€‚A çš„æç›Šå…©å¹³é»å…¶å¯¦è¼ƒé«˜ï¼Œé¢¨éšªè¼ƒå¤§ã€‚" }
                ]
            },
            {
                id: 3,
                title: "ç”¢èƒ½å—é™ä¸‹çš„ç‰¹åˆ¥è¨‚å–®",
                badge: "Level 3: Relevant Costing",
                scenario: `
                    <p><strong>æƒ…å¢ƒï¼š</strong> å…¬å¸ç”¢èƒ½å·²æ»¿è¼‰ (10,000 å–®ä½)ï¼Œç›®å‰å…¨æ•¸éŠ·å”®çµ¦å¸¸è¦å®¢æˆ¶ï¼Œå–®åƒ¹ $200ï¼Œå–®ä½è®Šå‹•æˆæœ¬ $120ã€‚å›ºå®šæˆæœ¬åˆ†æ”¤æ¯å–®ä½ $30ã€‚</p>
                    <p>ç¾åœ¨æœ‰ä¸€ä½æ–°å®¢æˆ¶æå‡ºã€Œä¸€æ¬¡æ€§ç‰¹åˆ¥è¨‚å–®ã€ï¼Œæƒ³è³¼è²· 1,000 å–®ä½ï¼Œå‡ºåƒ¹ $150ã€‚æ¥å—æ­¤è¨‚å–®ç„¡éœ€é¡å¤–è¡ŒéŠ·è²»ç”¨ï¼Œä½†ç”±æ–¼ç”¢èƒ½æ»¿è¼‰ï¼Œå¿…é ˆçŠ§ç‰² 1,000 å–®ä½çš„å¸¸è¦éŠ·é‡ä¾†æ»¿è¶³æ­¤è¨‚å–®ã€‚</p>
                `,
                question: "ä½œç‚º CFOï¼Œæ‚¨æ‡‰å»ºè­°æ¥å—é‚„æ˜¯æ‹’çµ•ï¼Ÿå°å…¬å¸åˆ©æ½¤çš„å½±éŸ¿ç‚ºä½•ï¼Ÿ",
                options: [
                    { text: "æ¥å—ï¼Œå› ç‚ºå‡ºåƒ¹ $150 é«˜æ–¼å–®ä½è®Šå‹•æˆæœ¬ $120ï¼Œæ¯å–®ä½å¤šè³º $30ã€‚", isCorrect: false, feedback: "éŒ¯èª¤ã€‚æ‚¨å¿½ç•¥äº†æ©Ÿæœƒæˆæœ¬ã€‚å› ç‚ºç”¢èƒ½æ»¿è¼‰ï¼Œæ¥å–®å¿…é ˆæ’æ“ åˆ©æ½¤æ›´é«˜çš„å¸¸è¦è¨‚å–®ã€‚" },
                    { text: "æ‹’çµ•ï¼Œå› ç‚ºå‡ºåƒ¹ $150 ä½æ–¼å®Œå…¨æˆæœ¬ $150 ($120 + $30)ï¼Œç„¡åˆ©å¯åœ–ã€‚", isCorrect: false, feedback: "éŒ¯èª¤ã€‚æ²ˆæ²’æˆæœ¬ (å›ºå®šæˆæœ¬åˆ†æ”¤) ä¸æ‡‰ç´å…¥æ±ºç­–ï¼Œä½†æ­¤é¡Œé—œéµåœ¨æ–¼æ©Ÿæœƒæˆæœ¬ã€‚" },
                    { text: "æ‹’çµ•ï¼Œæ¥å—æ­¤è¨‚å–®å°‡ä½¿å…¬å¸ç¸½åˆ©æ½¤æ¸›å°‘ $50,000ã€‚", isCorrect: true, feedback: "æ­£ç¢ºï¼<br>æ©Ÿæœƒæˆæœ¬ (çŠ§ç‰²å¸¸è¦è¨‚å–®çš„ CM) = ($200 - $120) = $80ã€‚<br>æ–°è¨‚å–®å¸¶ä¾†çš„ CM = ($150 - $120) = $30ã€‚<br>æ¯æ¥å—ä¸€å–®ä½ï¼Œåè€Œæå¤± $50 ($30 - $80)ã€‚ç¸½æå¤± = 1,000 Ã— $50 = $50,000ã€‚" },
                    { text: "æ¥å—ï¼Œä½†å‰ææ˜¯æ–°å®¢æˆ¶é¡˜æ„æé«˜å‡ºåƒ¹è‡³ $180ã€‚", isCorrect: false, feedback: "å³ä½¿å‡ºåƒ¹ $180ï¼Œä»ä½æ–¼å¸¸è¦è¨‚å–®å¸¶ä¾†çš„ $200 åƒ¹å€¼ (å‡è¨­è®Šå‹•æˆæœ¬ç›¸åŒ)ï¼Œä»ç„¶ä¸åˆ’ç®—ã€‚" }
                ]
            },
            {
                id: 4,
                title: "éƒ¨é–€ç¸¾æ•ˆè©•ä¼°ï¼šROI vs RI",
                badge: "Level 4: Performance Evaluation",
                scenario: `
                    <p><strong>æƒ…å¢ƒï¼š</strong> æŠ•è³‡ä¸­å¿ƒç¶“ç† Mary æ­£è€ƒæ…®ä¸€å€‹æ–°æŠ•è³‡æ¡ˆï¼šæŠ•è³‡é¡ $1,000,000ï¼Œé è¨ˆæ¯å¹´ç”¢ç”Ÿç‡Ÿæ¥­åˆ©ç›Š $160,000 (ROI = 16%)ã€‚</p>
                    <p>ç›®å‰ Mary æ‰€ç®¡è½„éƒ¨é–€çš„ç¾æœ‰ ROI ç‚º 20%ã€‚å…¬å¸çš„è³‡é‡‘æˆæœ¬ (Required Rate of Return) ç‚º 12%ã€‚</p>
                    <p>Mary ä¼¼ä¹ä¸å¤ªæƒ³åŸ·è¡Œé€™å€‹è¨ˆç•«ï¼Œä½†ç¸½å…¬å¸èªç‚ºé€™å°é›†åœ˜æœ‰åˆ©ã€‚</p>
                `,
                question: "ç‚ºä½•æœƒå‡ºç¾ç›®æ¨™ä¸ä¸€è‡´ (Goal Congruence) å•é¡Œï¼Ÿå¦‚æœæ”¹ç”¨å‰©é¤˜åˆ©ç›Š (Residual Income, RI) è©•ä¼°ï¼ŒMary çš„æ±ºç­–æœƒæ”¹è®Šå—ï¼Ÿ",
                options: [
                    { text: "Mary æ‹’çµ•æ˜¯å› ç‚ºæ–°æ¡ˆ ROI (16%) ä½æ–¼å¥¹ç›®å‰çš„ ROI (20%)ï¼Œæœƒæ‹‰ä½ç¸¾æ•ˆã€‚è‹¥æ”¹ç”¨ RIï¼Œæ–°æ¡ˆ RI ç‚ºæ­£ ($40,000)ï¼Œå¥¹å°±æœƒæ¥å—ã€‚", isCorrect: true, feedback: "å®Œå…¨æ­£ç¢ºï¼<br>ROI åˆ¶åº¦ä¸‹ï¼Œç¶“ç†å‚¾å‘æ‹’çµ•ã€Œé«˜æ–¼è³‡é‡‘æˆæœ¬ä½†ä½æ–¼ç›®å‰ç¸¾æ•ˆã€çš„æ¡ˆä»¶ã€‚<br>RI = ç²åˆ© - (æŠ•è³‡é¡ Ã— è³‡é‡‘æˆæœ¬) = 160,000 - (1,000,000 Ã— 12%) = +40,000ã€‚RI å¢åŠ ï¼Œç¶“ç†å°±æœƒé¡˜æ„æŠ•è³‡ï¼Œé”æˆç›®æ¨™ä¸€è‡´æ€§ã€‚" },
                    { text: "Mary æ‹’çµ•æ˜¯å› ç‚ºæ–°æ¡ˆ ROI ä½æ–¼è³‡é‡‘æˆæœ¬ã€‚æ”¹ç”¨ RI ä¹Ÿä¸æœƒæ”¹è®Šçµæœã€‚", isCorrect: false, feedback: "éŒ¯èª¤ã€‚æ–°æ¡ˆ ROI 16% é«˜æ–¼è³‡é‡‘æˆæœ¬ 12%ï¼Œå°å…¬å¸æ˜¯æœ‰åˆ©çš„ã€‚" },
                    { text: "Mary æ‹’çµ•æ˜¯å› ç‚ºé¢¨éšªè€ƒé‡ã€‚æ”¹ç”¨ RI æœƒè®“æ•¸å­—è®Šè² ï¼Œå¥¹æ›´ä¸æœƒæ¥å—ã€‚", isCorrect: false, feedback: "éŒ¯èª¤ã€‚RI è¨ˆç®—ç‚º 160,000 - 120,000 = 40,000ï¼Œæ˜¯æ­£æ•¸ã€‚" },
                    { text: "é€™ç´”ç²¹æ˜¯æºé€šå•é¡Œï¼Œèˆ‡ç¸¾æ•ˆæŒ‡æ¨™ (ROI æˆ– RI) ç„¡é—œã€‚", isCorrect: false, feedback: "éŒ¯èª¤ã€‚é€™æ˜¯ç¶“å…¸çš„ ROI ç¸¾æ•ˆè©•ä¼°ç¼ºé™·æ¡ˆä¾‹ã€‚" }
                ]
            }
        ];

        const game = {
            currentLevelIndex: 0,
            score: 0,
            
            init: function() {
                this.updateStats();
                this.renderLevel();
            },

            start: function() {
                document.getElementById('intro-screen').style.display = 'none';
                document.getElementById('game-area').style.display = 'block';
                this.init();
            },

            renderLevel: function() {
                const level = levels[this.currentLevelIndex];
                
                // Update UI
                document.getElementById('level-display').textContent = `${this.currentLevelIndex + 1} / ${levels.length}`;
                document.getElementById('level-badge').textContent = level.badge;
                document.getElementById('scenario-title').textContent = level.title;
                document.getElementById('scenario-text').innerHTML = level.scenario;
                document.getElementById('question-text').textContent = level.question;
                
                // Update Progress Bar
                const progress = ((this.currentLevelIndex) / levels.length) * 100;
                document.getElementById('progress-bar').style.width = `${progress}%`;

                // Render Options
                const optionsGrid = document.getElementById('options-grid');
                optionsGrid.innerHTML = '';
                
                level.options.forEach((opt, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerHTML = `<strong style="color:var(--accent)">${String.fromCharCode(65+index)}.</strong> ${opt.text}`;
                    btn.onclick = () => this.checkAnswer(index);
                    optionsGrid.appendChild(btn);
                });
            },

            checkAnswer: function(selectedIndex) {
                const level = levels[this.currentLevelIndex];
                const option = level.options[selectedIndex];
                const btns = document.querySelectorAll('.option-btn');

                // Disable all buttons
                btns.forEach(btn => btn.disabled = true);

                // Highlight buttons
                btns[selectedIndex].classList.add(option.isCorrect ? 'correct' : 'wrong');
                if (!option.isCorrect) {
                    // Find correct one
                    level.options.forEach((opt, idx) => {
                        if (opt.isCorrect) btns[idx].classList.add('correct');
                    });
                }

                // Show Feedback
                this.showFeedback(option.isCorrect, option.feedback);

                // Update Score
                if (option.isCorrect) {
                    this.score += 100;
                    this.updateStats();
                } else {
                    this.score = Math.max(0, this.score - 20); // Penalty
                    this.updateStats();
                }
            },

            showFeedback: function(isCorrect, message) {
                const overlay = document.getElementById('feedback-overlay');
                const icon = document.getElementById('feedback-icon');
                const title = document.getElementById('feedback-title');
                const msg = document.getElementById('feedback-message');
                const btn = document.getElementById('feedback-btn');

                overlay.style.display = 'flex';
                icon.textContent = isCorrect ? 'ğŸ‰' : 'âš ï¸';
                title.textContent = isCorrect ? 'æ±ºç­–æ­£ç¢º' : 'æ±ºç­–å¤±èª¤';
                title.style.color = isCorrect ? 'var(--success)' : 'var(--error)';
                msg.innerHTML = message;

                if (isCorrect) {
                    if (this.currentLevelIndex === levels.length - 1) {
                        btn.textContent = "é ˜å–çµæ¥­è­‰æ›¸";
                        btn.onclick = () => this.finishGame();
                    } else {
                        btn.textContent = "ä¸‹ä¸€é—œ";
                        btn.onclick = () => {
                            overlay.style.display = 'none';
                            this.currentLevelIndex++;
                            this.renderLevel();
                        };
                    }
                } else {
                    btn.textContent = "å†è©¦ä¸€æ¬¡";
                    btn.onclick = () => {
                        overlay.style.display = 'none';
                        this.renderLevel(); // Reset buttons
                    };
                }
            },

            updateStats: function() {
                document.getElementById('score-display').textContent = this.score;
            },

            finishGame: function() {
                const overlay = document.getElementById('feedback-overlay');
                overlay.innerHTML = `
                    <div class="feedback-card">
                        <span class="feedback-icon">ğŸ†</span>
                        <h2 class="feedback-title" style="color:var(--gold)">æ­å–œé€šé—œï¼</h2>
                        <p class="feedback-message">
                            æ‚¨å·²æˆåŠŸé€šéæ‰€æœ‰ç®¡ç†æœƒè¨ˆæ±ºç­–æŒ‘æˆ°ã€‚<br>
                            æœ€çµ‚å¾—åˆ†ï¼š<strong style="color:var(--gold); font-size:1.5rem">${this.score}</strong>
                        </p>
                        <button class="next-btn" onclick="location.reload()">é‡æ–°æŒ‘æˆ°</button>
                    </div>
                `;
            }
        };
    </script>
</body>
</html>
